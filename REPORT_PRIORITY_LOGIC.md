# 📊 Slack 보고서 우선순위 로직

## 🎯 핵심 원칙

1. **평일만 보고** (월-금)
2. **하루에 1개 보고서만**
3. **우선순위: 월간 > 주간 > 일간**
4. **포함 관계**:
   - 월간 = 30일 데이터 (주간/일간 모두 포함)
   - 주간 = 7일 데이터 (일간 포함)
   - 일간 = 24시간 데이터

## 📅 실행 스케줄

```yaml
schedule:
  - cron: '0 0 * * 1-5'  # 평일 오전 9시 (KST)
```

- **월요일-금요일**: 오전 9시 자동 실행
- **토요일-일요일**: 실행 안 함 (수동 실행만 가능)

## 🔄 우선순위 판단 로직

```bash
if [ 매월 1일 ]; then
    → 월간 보고서 (일간/주간 대체)
elif [ 월요일 ]; then
    → 주간 보고서 (일간 대체)
else
    → 일간 보고서
fi
```

## 📋 월별 보고서 생성 예시

### 2025년 1월
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 1월 1일 | 수 | **월간** | 신정 (공휴일이지만 1일이므로 월간) |
| 1월 2일 | 목 | 일간 | 평일 |
| 1월 3일 | 금 | 일간 | 평일 |
| 1월 6일 | 월 | **주간** | 월요일 |
| 1월 7일 | 화 | 일간 | 평일 |
| ... | ... | ... | ... |
| 1월 13일 | 월 | **주간** | 월요일 |
| 1월 20일 | 월 | **주간** | 월요일 |
| 1월 27일 | 월 | **주간** | 월요일 |

### 2025년 2월
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 2월 3일 | 월 | **주간** | 1일이 토요일이므로 월요일에 주간 |
| 2월 4일 | 화 | 일간 | 평일 |
| 2월 10일 | 월 | **주간** | 월요일 |
| ... | ... | ... | ... |

### 2025년 3월
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 3월 3일 | 월 | **주간** | 1일이 토요일이므로 월요일에 주간 |
| 3월 4일 | 화 | 일간 | 평일 |
| ... | ... | ... | ... |

### 2025년 4월
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 4월 1일 | 화 | **월간** | 1일 (평일) |
| 4월 2일 | 수 | 일간 | 평일 |
| 4월 7일 | 월 | **주간** | 월요일 |
| ... | ... | ... | ... |

### 2025년 9월
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 9월 1일 | 월 | **월간** ✅ | 1일이면서 월요일 → 월간 우선 |
| 9월 2일 | 화 | 일간 | 평일 |
| 9월 8일 | 월 | **주간** | 월요일 |
| ... | ... | ... | ... |

## 🎯 특수 케이스 처리

### 케이스 1: 1일이 월요일
- **상황**: 월간 보고와 주간 보고가 충돌
- **결과**: **월간 보고서만** (우선순위 높음)
- **이유**: 월간이 주간 데이터를 모두 포함

### 케이스 2: 1일이 주말
- **상황**: 자동 실행 안 됨
- **결과**: 다음 평일에 일간 또는 주간 보고
- **수동 실행**: 가능 (workflow_dispatch)

### 케이스 3: 공휴일
- **상황**: GitHub Actions는 공휴일 인식 안 함
- **결과**: 평일이면 정상 실행
- **대안**: 수동으로 skip 또는 별도 처리

## 💻 수동 실행 옵션

```yaml
workflow_dispatch:
  inputs:
    report_type:
      - auto      # 자동 판단 (우선순위 적용)
      - daily     # 강제 일간
      - weekly    # 강제 주간  
      - monthly   # 강제 월간
```

## 📊 연간 보고서 통계 (예상)

- **일간 보고서**: 약 200회/년
  - 평일 250일 - 월간 12회 - 주간 40회
- **주간 보고서**: 약 48회/년
  - 매주 월요일 (1일과 겹치는 경우 제외)
- **월간 보고서**: 12회/년
  - 매월 1일 (주말 제외)

## 🔧 설정 변경 방법

### 보고 시간 변경
```yaml
# 오전 10시로 변경
- cron: '0 1 * * 1-5'  # UTC 1:00 = KST 10:00
```

### 우선순위 변경
```bash
# 주간 > 월간 > 일간으로 변경하려면
if [ "$DAY_OF_WEEK" = "1" ]; then
    REPORT_TYPE="weekly"
elif [ "$DAY_OF_MONTH" = "01" ]; then
    REPORT_TYPE="monthly"
else
    REPORT_TYPE="daily"
fi
```

## 📝 참고사항

1. **데이터 중복 없음**: 상위 보고서가 하위 데이터 포함
2. **효율성**: 불필요한 중복 보고 제거
3. **유연성**: 수동 실행으로 언제든 모든 타입 생성 가능
4. **예측 가능성**: 명확한 우선순위로 혼란 방지

---

최종 업데이트: 2025-08-07