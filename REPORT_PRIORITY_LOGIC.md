# 📊 Slack 보고서 우선순위 로직

## 🎯 핵심 원칙

1. **평일만 보고** (월-금)
2. **하루에 1개 보고서만**
3. **우선순위: 월간 > 주간 > 일간**
4. **월간 보고**: **매월 첫째주 월요일** (1-7일 사이)
5. **포함 관계**:
   - 월간 = 30일 데이터 (주간/일간 모두 포함)
   - 주간 = 7일 데이터 (일간 포함)
   - 일간 = 24시간 데이터

## 📅 실행 스케줄

```yaml
schedule:
  - cron: '0 0 * * 1-5'  # 평일 오전 9시 (KST)
```

- **월요일-금요일**: 오전 9시 자동 실행
- **토요일-일요일**: 실행 안 함 (수동 실행만 가능)

## 🔄 우선순위 판단 로직

```bash
if [ 월요일 AND 1-7일 사이 ]; then
    → 월간 보고서 (첫째주 월요일, 일간/주간 대체)
elif [ 월요일 ]; then
    → 주간 보고서 (일간 대체)
else
    → 일간 보고서
fi
```

## 📋 월별 보고서 생성 예시

### 2025년 월간 보고서 날짜 (첫째주 월요일)
| 월 | 날짜 | 요일 | 설명 |
|------|------|------|------|
| 1월 | 1월 6일 | 월 | **월간** 보고서 |
| 2월 | 2월 3일 | 월 | **월간** 보고서 |
| 3월 | 3월 3일 | 월 | **월간** 보고서 |
| 4월 | 4월 7일 | 월 | **월간** 보고서 |
| 5월 | 5월 5일 | 월 | **월간** 보고서 |
| 6월 | 6월 2일 | 월 | **월간** 보고서 |
| 7월 | 7월 7일 | 월 | **월간** 보고서 |
| 8월 | 8월 4일 | 월 | **월간** 보고서 |
| 9월 | 9월 1일 | 월 | **월간** 보고서 |
| 10월 | 10월 6일 | 월 | **월간** 보고서 |
| 11월 | 11월 3일 | 월 | **월간** 보고서 |
| 12월 | 12월 1일 | 월 | **월간** 보고서 |

### 보고서 생성 예시 (2025년 1월)
| 날짜 | 요일 | 보고서 타입 | 설명 |
|------|------|------------|------|
| 1월 1일 | 수 | 일간 | 평일 |
| 1월 2일 | 목 | 일간 | 평일 |
| 1월 3일 | 금 | 일간 | 평일 |
| 1월 6일 | 월 | **월간** ✅ | 첫째주 월요일 |
| 1월 7일 | 화 | 일간 | 평일 |
| 1월 13일 | 월 | **주간** | 둘째주 월요일 |
| 1월 20일 | 월 | **주간** | 셋째주 월요일 |
| 1월 27일 | 월 | **주간** | 넷째주 월요일 |

## 🎯 특수 케이스 처리

### 케이스 1: 첫째주 월요일이 1일
- **상황**: 9월 1일, 12월 1일 (2025년)
- **결과**: **월간 보고서** (첫째주 월요일)
- **이유**: 1-7일 사이의 월요일이므로 월간 보고

### 케이스 2: 첫째주 월요일이 7일
- **상황**: 4월 7일, 7월 7일 (2025년)
- **결과**: **월간 보고서** (첫째주 월요일)
- **이유**: 일요일이 1일인 경우 월요일이 7일

### 케이스 3: 1일이 주말
- **상황**: 2월 1일(토), 3월 1일(토), 6월 1일(일), 11월 1일(토)
- **결과**: 자동 실행 안 됨
- **월간 보고**: 다음 월요일에 실행 (첫째주 월요일)

### 케이스 3: 공휴일
- **상황**: GitHub Actions는 공휴일 인식 안 함
- **결과**: 평일이면 정상 실행
- **대안**: 수동으로 skip 또는 별도 처리

## 💻 수동 실행 옵션

```yaml
workflow_dispatch:
  inputs:
    report_type:
      - auto      # 자동 판단 (우선순위 적용)
      - daily     # 강제 일간
      - weekly    # 강제 주간  
      - monthly   # 강제 월간
```

## 📊 2025년 연간 보고서 통계

- **일간 보고서**: 209회/년 (80.1%)
  - 평일 261일 - 월간 12회 - 주간 40회
- **주간 보고서**: 40회/년 (15.3%)
  - 월요일 52회 - 월간 12회
- **월간 보고서**: 12회/년 (4.6%)
  - 매월 첫째주 월요일 (1-7일 사이)
- **총 보고서**: 261회/년

## 🔧 설정 변경 방법

### 보고 시간 변경
```yaml
# 오전 10시로 변경
- cron: '0 1 * * 1-5'  # UTC 1:00 = KST 10:00
```

### 우선순위 변경
```bash
# 주간 > 월간 > 일간으로 변경하려면
if [ "$DAY_OF_WEEK" = "1" ]; then
    REPORT_TYPE="weekly"
elif [ "$DAY_OF_MONTH" = "01" ]; then
    REPORT_TYPE="monthly"
else
    REPORT_TYPE="daily"
fi
```

## 📝 참고사항

1. **데이터 중복 없음**: 상위 보고서가 하위 데이터 포함
2. **효율성**: 불필요한 중복 보고 제거
3. **유연성**: 수동 실행으로 언제든 모든 타입 생성 가능
4. **예측 가능성**: 명확한 우선순위로 혼란 방지

---

최종 업데이트: 2025-08-07